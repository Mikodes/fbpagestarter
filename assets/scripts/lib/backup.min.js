(function(e){e.fn.fbStarter=function(t){var i=e.extend({appId:"",pageId:"",status:true,cookie:true,xfbml:true,locales:"en_US",activeFangate:false,likedPage:"like-wrapper",unlikePage:"unlike-wrapper",canvasUrl:"",callbackFunction:""},t);var n=i.canvasUrl+"/channel.html";window.fbInit=window.fbInit||false;if(window.fbInit){e(document).trigger("fb:initialized");if(i.xfbml){FB.XFBML.parse()}return}window.fbAsyncInit=function(){window.fbInit=true;e(document).trigger("fb:initializing");FB.init(i);e(document).trigger("fb:initialized");if(i.activeFangate){FB.getLoginStatus(function(t){if(t.status=="connected"){var n=t.authResponse.userID;var a=i.pageId;var o="SELECT uid FROM page_fan WHERE page_id ="+a+" and uid="+n;var l=FB.Data.query(o);l.wait(function(t){if(t.length==1&&t[0].uid==n){e("#"+i.likedPage).show()}else{e("#"+i.unlikePage).show()}})}else{console.log("not login")}})}};var a="fb-root";if(!document.getElementById(a)){var o=document.createElement("div");o.id=a;document.body.appendChild(o)}var l,c="facebook-jssdk";if(!document.getElementById(c)){l=document.createElement("script");l.id=c;l.async=true;l.src="//connect.facebook.net/"+i.locales+"/all.js";document.getElementsByTagName("head")[0].appendChild(l)}e("#install_to_page").click(function(t){t.preventDefault();console.log("addtab");var n=i.canvasUrl+"install_to_page.html";FB.ui({method:"pagetab",redirect_uri:n},function(t){if(t!=null&&t.tabs_added!=null){e.each(t.tabs_added,function(t){FB.api(t,function(t){e("#msg").text("Your tab has already been installed");alert("redirect to "+t.link)})})}else{e("#msg").text("Action cancelled, unable to install a page");alert("Unable to install")}})});return this.each(function(){var t=e(this);t.bind({share:n,permissions:a});e(".fb-dialog").click(function(t){t.preventDefault();var i=e(this).data("fbactiontype");if($dialogType="share"){e(this).trigger("share");console.log(i)}else if($dialogType="permissions"){e(this).trigger("permissions");console.log(i)}});function n(){var t={method:"feed",link:e(this).data("link"),picture:e(this).data("pic"),title:e(this).data("title"),caption:e(this).data("caption"),description:e(this).data("description")};FB.ui(t)}function a(){var t=e(this).data("permissions");FB.login(function(e){if(e.authResponse){console.log("Welcome!  Fetching your information.... ");FB.api("/me",function(e){console.log("Good to see you, "+e.name+".")})}else{console.log("User cancelled login or did not fully authorize.")}},{scope:t})}if(e.isFunction(i.callbackFunction)){i.callbackFunction.call(this)}})}})(jQuery);